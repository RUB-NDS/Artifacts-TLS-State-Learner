/*
 * TLS-StateBulnFinder - A state machine analysis tool based on TLS-Attacker
 *
 * Copyright 2020-2023 Ruhr University Bochum and Paderborn University
 *
 * Licensed under Apache License, Version 2.0
 * http://www.apache.org/licenses/LICENSE-2.0.txt
 */
package de.rub.nds.statevulnfinder.core.issue;

import de.rub.nds.statevulnfinder.core.algorithm.words.TlsWord;
import de.rub.nds.statevulnfinder.core.constants.StateMachineIssueType;
import java.util.List;

/**
 * @author robert
 */
public class DivergingBleichenbacherVulnerability extends BBAndPOVulnerability
        implements StateDivergenceIssue {

    private final Object sourceNode;
    private final Object firstTargetNode;
    private final Object secondTargetNode;
    private final List<TlsWord> accessSequence;
    private final TlsWord firstWord;
    private final TlsWord secondWord;

    public DivergingBleichenbacherVulnerability(
            Object sourceNode,
            Object firstTargetNode,
            Object secondTargetNode,
            String reason,
            TlsWord firstWord,
            TlsWord secondWord,
            List<TlsWord> accessSequence) {
        super(StateMachineIssueType.BLEICHENBACHER, reason);
        this.sourceNode = sourceNode;
        this.firstTargetNode = firstTargetNode;
        this.secondTargetNode = secondTargetNode;
        this.accessSequence = accessSequence;
        this.firstWord = firstWord;
        this.secondWord = secondWord;
    }

    @Override
    public String toString() {
        return "DivergingBleichenbacherVulnerability{"
                + "sourceNode="
                + sourceNode
                + ", firstTargetNode="
                + firstTargetNode
                + ", firstInput="
                + firstWord
                + ", secondInput="
                + secondWord
                + ", secondTargetNode="
                + secondTargetNode
                + '}';
    }

    @Override
    public List<TlsWord> getPath() {
        return accessSequence;
    }

    public Object getSourceNode() {
        return sourceNode;
    }

    public TlsWord getFirstWord() {
        return firstWord;
    }

    public TlsWord getSecondWord() {
        return secondWord;
    }
}
